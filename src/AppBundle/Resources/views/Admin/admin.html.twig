{% extends "layout/admin_layout.html.twig" %}

{% block body %}
    <!-- Page Heading -->
    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">
                Tableau de bord <small>Récapitulatif des statistiques</small>
            </h1>
            <ol class="breadcrumb">
                <li class="active">
                    <i class="fa fa-dashboard"></i> Tableau de bord
                </li>
            </ol>
            <div id="embed-api-auth-container"></div>
        </div>
    </div>
    <!-- /.row -->
    {% if data.flashbag  %}
        <div class="row">
            <div class="col-lg-12">
                <div class="alert alert-info alert-dismissable">
                    
                </div>
            </div>
        </div>
    {% endif %}
    <!-- /.row -->

    <div class="row">
        <div class="col-lg-3 col-md-6">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-map-marker fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div class="huge">{{ data.nbObservation }}</div>
                            <div>Observations</div>
                        </div>
                    </div>
                </div>
                <div class="panel-footer">
                    <span class="pull-left">Nombre d'observations validées</span>
                    <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="panel panel-green">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-user fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div class="huge">{{ data.nbUsers }}</div>
                            <div>Nombre d'utilisateurs</div>
                        </div>
                    </div>
                </div>
                <div class="panel-footer">
                    <span class="pull-left">Nombre total de comptes actifs</span>
                    <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="panel panel-yellow">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-info-circle fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div class="huge">124</div>
                            <div>Nombre de pages vues</div>
                        </div>
                    </div>
                </div>
                <div class="panel-footer">
                    <span class="pull-left">Nombre de page visitées depuis le lancement du site</span>
                    <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="panel panel-red">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-clock-o fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div class="huge">{{ data.observationSubmited|length }}</div>
                            <div>Observations en attentes</div>
                        </div>
                    </div>
                </div>
                <div class="panel-footer">
                    <span class="pull-left">Nombre d'observations en attentes de validations</span>
                    <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
    </div>
    <!-- /.row -->

    <div class="row">
        <div class="col-lg-12">
            <ol class="breadcrumb">
                <li class="active">
                    <i class="fa fa-dashboard"></i> Graphiques <div id="embed-api-auth-container"></div>
                </li>
            </ol>
        </div>
    </div>
    <!-- /.row -->

    <div class="row">
        <div class="col-lg-4">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title"><i class="fa fa-long-arrow-right fa-fw"></i> Google Analytics 1</h3>
                </div>
                <div class="panel-body">
                    <div id="chart-1-container"></div>
                    <div id="view-selector-1-container"></div>
                    <div class="text-right">
                        <a href="#">Plus de détails <i class="fa fa-arrow-circle-right"></i></a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title"><i class="fa fa-long-arrow-right fa-fw"></i> Google Analytics 2</h3>
                </div>
                <div class="panel-body">
                    <div id="chart-2-container"></div>
                    <div id="view-selector-2-container"></div>
                    <div class="text-right">
                        <a href="#">Plus de détails <i class="fa fa-arrow-circle-right"></i></a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title"><i class="fa fa-long-arrow-right fa-fw"></i> Google Analytics 3</h3>
                </div>
                <div class="panel-body">
                    <div id="chart-3-container"></div>
                    <div id="view-selector-3-container"></div>
                    <div class="text-right">
                        <a href="#">Plus de détails <i class="fa fa-arrow-circle-right"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /.row -->

    <div class="row">
        <div class="col-lg-12">
            <ol class="breadcrumb">
                <li class="active">
                    <i class="fa fa-dashboard"></i> Réseaux Sociaux
                </li>
            </ol>
        </div>
    </div>
    <!-- /.row -->

    <div class="row">
        <div class="col-lg-3 col-md-6">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-facebook fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div class="huge">1423</div>
                            <div>Abonnés Facebbok</div>
                        </div>
                    </div>
                </div>
                <div class="panel-footer">
                    <span class="pull-left">Nombre d'abonnés à votre page Facebook</span>
                    <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
    </div>
    <!-- /.row -->
    <script>
        gapi.analytics.ready(function() {

          /**
           * Authorize the user immediately if the user has already granted access.
           * If no access has been created, render an authorize button inside the
           * element with the ID "embed-api-auth-container".
           */
          gapi.analytics.auth.authorize({
            container: 'embed-api-auth-container',
            clientid: '333550444833-59bmb88rorl5ingb02d9ip0nphpej37i.apps.googleusercontent.com'
          });


          /**
           * Create a new ViewSelector instance to be rendered inside of an
           * element with the id "view-selector-container".
           */
          var viewSelector1 = new gapi.analytics.ViewSelector({
            container: 'view-selector-1-container'
          });
          /**
           * Create a ViewSelector for the second view to be rendered inside of an
           * element with the id "view-selector-2-container".
           */
          var viewSelector2 = new gapi.analytics.ViewSelector({
            container: 'view-selector-2-container'
          });
          /**
           * Create a ViewSelector for the second view to be rendered inside of an
           * element with the id "view-selector-2-container".
           */
          var viewSelector3 = new gapi.analytics.ViewSelector({
            container: 'view-selector-3-container'
          });

          // Render the view selector to the page.
          viewSelector1.execute();
          viewSelector2.execute();
          viewSelector3.execute();


          /**
           * Create a new DataChart instance with the given query parameters
           * and Google chart options. It will be rendered inside an element
           * with the id "chart-container".
           */
          var dataChart1 = new gapi.analytics.googleCharts.DataChart({
            query: {
              metrics: 'ga:sessions',
              dimensions: 'ga:date',
              'start-date': '7daysAgo',
              'end-date': 'yesterday'
            },
            chart: {
              container: 'chart-1-container',
              type: 'LINE',
              options: {
                width: '90%'
              }
            }
          });

          /**
           * Create the second DataChart for top countries over the past 30 days.
           * It will be rendered inside an element with the id "chart-2-container".
           */
          var dataChart2 = new gapi.analytics.googleCharts.DataChart({
            query: {
              metrics: 'ga:sessions',
              dimensions: 'ga:country',
              'start-date': '30daysAgo',
              'end-date': 'yesterday',
              'max-results': 6,
              sort: '-ga:sessions'
            },
            chart: {
              container: 'chart-2-container',
              type: 'PIE',
              options: {
                width: '90%',
                pieHole: 4/9
              }
            }
          });

          var dataChart3 = new gapi.analytics.googleCharts.DataChart({
            query: {
              'dimensions': 'ga:browser',
              'metrics': 'ga:sessions',
              'sort': '-ga:sessions',
              'max-results': '6'
            },
            chart: {
              type: 'TABLE',
              container: 'chart-3-container',
              options: {
                width: '90%'
              }
            }
          });


          /**
           * Render the dataChart on the page whenever a new view is selected.
           */
          viewSelector1.on('change', function(ids) {
            dataChart1.set({query: {ids: ids}}).execute();
          });
          /**
           * Update the second dataChart when the second view selecter is changed.
           */
          viewSelector2.on('change', function(ids) {
            dataChart2.set({query: {ids: ids}}).execute();
          });
          /**
           * Update the second dataChart when the second view selecter is changed.
           */
          viewSelector3.on('change', function(ids) {
            dataChart3.set({query: {ids: ids}}).execute();
          });


        });
    </script>
{% endblock %}
